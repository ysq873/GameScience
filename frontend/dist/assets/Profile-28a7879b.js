import{r as c}from"./request-db331112.js";import{_ as h,r as n,o as g,c as y,a as t,b as r,w as o,t as f,e as w,d as l}from"./index-1e67ce6d.js";function F(){return c({url:"/user/profile",method:"get"})}function b(s){return c({url:"/user/favorites",method:"post",data:{item:s}})}const k={name:"Profile",data(){return{user:{id:"",email:"",name:{first:"",last:""},favorites:[]},newFavorite:"",addingFavorite:!1}},async created(){await this.loadProfile()},methods:{async loadProfile(){try{const s=await F();this.user=s.data}catch{this.$message.error("获取用户资料失败")}},async addFavorite(){if(!this.newFavorite.trim()){this.$message.warning("请输入收藏内容");return}this.addingFavorite=!0;try{const s=await b(this.newFavorite.trim());this.user=s.data,this.newFavorite="",this.$message.success("添加收藏成功")}catch{this.$message.error("添加收藏失败")}finally{this.addingFavorite=!1}},removeFavorite(s){this.$confirm("确定要删除这个收藏吗？","提示",{type:"warning"}).then(()=>{this.user.favorites.splice(s,1),this.$message.success("删除成功")})},handleLogout(){this.$confirm("确定要退出登录吗？","提示",{type:"warning"}).then(()=>{this.$store.commit("CLEAR_USER"),this.$router.push("/login")})}}},C={class:"profile-container"},x={class:"profile-card"},P={class:"profile-info"},V={class:"info-item"},$={class:"info-item"},B={class:"add-favorite"},E={class:"actions"};function K(s,e,L,N,a,d){const m=n("el-card"),v=n("el-input"),u=n("el-button"),p=n("el-table-column"),_=n("el-table");return g(),y("div",C,[t("div",x,[e[10]||(e[10]=t("h2",null,"个人资料",-1)),r(m,{class:"info-card"},{header:o(()=>[...e[2]||(e[2]=[t("div",{class:"card-header"},[t("span",null,"基本信息")],-1)])]),default:o(()=>[t("div",P,[t("div",V,[e[3]||(e[3]=t("label",null,"邮箱:",-1)),t("span",null,f(a.user.email),1)]),t("div",$,[e[4]||(e[4]=t("label",null,"姓名:",-1)),t("span",null,f(a.user.name.first)+" "+f(a.user.name.last),1)])])]),_:1}),r(m,{class:"favorites-card"},{header:o(()=>[...e[5]||(e[5]=[t("div",{class:"card-header"},[t("span",null,"我的收藏")],-1)])]),default:o(()=>[t("div",B,[r(v,{modelValue:a.newFavorite,"onUpdate:modelValue":e[0]||(e[0]=i=>a.newFavorite=i),placeholder:"输入收藏项目",style:{width:"300px","margin-right":"1rem"},onKeyup:w(d.addFavorite,["enter"])},null,8,["modelValue","onKeyup"]),r(u,{type:"primary",onClick:d.addFavorite,loading:a.addingFavorite},{default:o(()=>[...e[6]||(e[6]=[l(" 添加收藏 ",-1)])]),_:1},8,["onClick","loading"])]),r(_,{data:a.user.favorites,style:{width:"100%","margin-top":"1rem"}},{default:o(()=>[r(p,{prop:"item",label:"收藏项目"},{default:o(i=>[l(f(i.row),1)]),_:1}),r(p,{label:"操作",width:"100"},{default:o(i=>[r(u,{type:"danger",link:"",onClick:R=>d.removeFavorite(i.$index)},{default:o(()=>[...e[7]||(e[7]=[l(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t("div",E,[r(u,{type:"primary",onClick:e[1]||(e[1]=i=>s.$router.push("/"))},{default:o(()=>[...e[8]||(e[8]=[l("返回首页",-1)])]),_:1}),r(u,{onClick:d.handleLogout},{default:o(()=>[...e[9]||(e[9]=[l("退出登录",-1)])]),_:1},8,["onClick"])])])])}const q=h(k,[["render",K],["__scopeId","data-v-2356d3fa"]]);export{q as default};
